





\section{Introduction}
\label{sec-1}



\lstset{language=R}
\begin{lstlisting}
library(raster)

old <- setwd('~/Datos/CMSAF')
listFich <- dir(pattern='SISdm2011')
stackSIS <- stack(listFich)
setwd(old)

timeIndex <- seq(as.Date('2011-01-01'), by='day', length=365)

SISdm <- setZ(stackSIS, timeIndex)
names(SISdm) <- format(timeIndex, '%a_%Y%m%d')
\end{lstlisting}
\section{Levelplot}
\label{sec-2}


\lstset{language=R}
\begin{lstlisting}
library(rasterVis)
levelplot(SISdm, layers=1:12)
\end{lstlisting}


\lstset{language=R}
\begin{lstlisting}
SISmm <- zApply(SISdm, by=as.yearmon, fun=mean)
\end{lstlisting}


\lstset{language=R}
\begin{lstlisting}
levelplot(SISmm)
\end{lstlisting}

\begin{figure}[h!]
\centering
\includegraphics[height=0.45\textheight]{figs/SISmm.pdf}
\caption{\label{SISmm}levelplot monthly means}
\end{figure}
\section{Histogram}
\label{sec-3}


\lstset{language=R}
\begin{lstlisting}
histogram(SISdm, FUN=as.yearmon)
\end{lstlisting}

\begin{figure}[h!]
\centering
\includegraphics[height=0.45\textheight]{figs/SISdm_histogram.pdf}
\caption{\label{SISdm_histo}levelplot monthly means}
\end{figure}
\section{Time series}
\label{sec-4}


\lstset{language=R}
\begin{lstlisting}
xyplot(SISdm)
\end{lstlisting}

\begin{figure}[h!]
\centering
\includegraphics[height=0.45\textheight]{figs/SISmm.pdf}
\caption{\label{SISmm}levelplot monthly means}
\end{figure}


\lstset{language=R}
\begin{lstlisting}
horizonplot(SISmm)
\end{lstlisting}

\begin{figure}[h!]
\centering
\includegraphics[height=0.45\textheight]{figs/SISdm_horizonplot.pdf}
\caption{\label{SISdm_horizonplot}levelplot monthly means}
\end{figure}
\section{Hovmoller}
\label{sec-5}


\lstset{language=R}
\begin{lstlisting}
hovmoller(SISmm)
\end{lstlisting}

\begin{figure}[h!]
\centering
\includegraphics[height=0.45\textheight]{figs/SISdm_horizonplot.pdf}
\caption{\label{SISdm_hovmoller}levelplot monthly means}
\end{figure}
\section{Animation}
\label{sec-6}


\lstset{language=R}
\begin{lstlisting}
old <- setwd(tempdir())
trellis.device(png, res=600, width=3000, height=3000)
levelplot(SISdm, layout=c(1, 1))
dev.off()
\end{lstlisting}


\lstset{language=R}
\begin{lstlisting}
convertCMD <- 'convert Rplot*.png -morph 5 morph%05d.jpg'
system(convertCMD)
movieCMD <- 'ffmpeg -r 10 -b 500000 -i morph%05d.jpg output.mp4'
system(movieCMD)
file.remove(dir(pattern='morph'))
file.remove(dir(pattern='Rplot'))
file.copy('output.mp4', paste0(old, '/output.mp4'))
setwd(old)
\end{lstlisting}
